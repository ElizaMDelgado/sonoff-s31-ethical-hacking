#  Final Report: Sonoff S31 Ethical Hacking

## 1. Introduction

This report summarizes the ethical hacking process applied to the Sonoff S31 smart plug running Tasmota firmware version 15.0.1. It includes:

- **Testing methodology** and tools used  
- **Confirmed findings** with proof and impact assessment  
- **Implemented fixes**  
- **Validation checklist results**  
- **CVSS scores** and overall recommendations

---

## 2. Methodology

1. **Blackbox testing** using `curl` for HTTP APIs  
2. **Firmware interaction** via UART for boot and shell access  
3. **Static and dynamic configuration analysis** (MQTT, OTA)  
4. **Network-level testing**, including VLAN segregation and firewall restrictions  
5. **Hardening validation** via checklist, firewall rules, and log monitoring

---

## 3. Findings & CVSS Scores

| ID   | Finding                                      | Severity | CVSS Score |
|------|----------------------------------------------|----------|------------|
| F01  | Unauthenticated Local API Access             | High     | 8.6        |
| F02  | MQTT Configuration Injection                 | High     | 7.5        |
| F03  | OTA URL Hijack                               | High     | 8.0        |
| F04  | Information Leakage via Status API           | Medium   | 5.4        |
| F05  | UART Shell Access (with physical access)     | Medium   | 6.8        |

*(See `fixes/cvss_scores.md` for vectors and reasoning.)*

---

## 4. Fixes Implemented

### 4.1 Credential Hardening
- Enabled authentication (`SetOption13 1`)  
- Enforced Web Admin username/password (`admin` + strong pass)  
*(See `fixes/credential_hardening.md`)*

### 4.2 Network Restrictions
- Configured firewall rules limiting port 80/1883 to trusted IPs  
- Implemented VLAN segmentation  
*(See `fixes/firewall_restrictions.md`)*

### 4.3 Mitigation Summary
A full list of mitigations is available in `fixes/mitigations.md`, linking each fix to its corresponding finding.

### 4.4 Monitoring Setup
- Enabled console-logging of commands  
- Optional MQTT telemetry  
- Checklists and alerts for unauthorized access  
*(See `fixes/monitoring_and_alerts.md`)*

---

## 5. Validation Results

All defenses were validated using `fixes/testing_checklist.md`. Key outcomes:

- API commands protected — **unauthenticated access blocked**
- MQTT and OTA changes restricted — only authorized users can modify
- Information leakage endpoints secured
- Firewall isolation confirmed — external hosts denied web/API access
- All checklist items marked **✅**

---

## 6. Recommendations

1. **Apply all fixes consistently:** hardening + monitoring + network isolation  
2. **Review Tasmota configs regularly** after firmware changes  
3. **Avoid exposing the device to the internet** directly  
4. **Use VLANs and firewall rules** as long-term defense strategies  
5. **Monitor console and network logs** for suspicious activity  
6. **Consider compiling Tasmota with hardened defaults** (see `secure_firmware_build.md` for details)

---

## 7. Conclusion

This project demonstrates a full lifecycle ethical hack—identifying critical vulnerabilities in a popular IoT device, implementing layered defensive controls, validating protections, and delivering a comprehensive final report. This framework not only ensures the immediate security of your Sonoff S31, but also serves as a repeatable, professional standard for IoT security auditing.

---

## 8. References

- Findings folder for detailed write-ups  
- Fixes folder for hardening guides  
- `fixes/cvss_scores.md` for severity scoring  
- `docs/README.md` and project README for overview

---

*Report generated by [Eliza Delgado] – last updated: July 17, 2025*
